%%%% neural network (to draw figures)
% Text on links
\tikzset{mystyle/.style={red, draw=blue, fill=yellow!20}}
\newcommand{\wilink}[4] {
    % from layer=#1, from node=#2, to layer=#3, to node=#4
    $w_{#2}$
}
\newcommand{\wijlink}[4] {
    % from layer=#1, from node=#2, to layer=#3, to node=#4
    $\scriptscriptstyle w_{#2#4}$
}
\newcommand{\wijllink}[4] {
    % from layer=#1, from node=#2, to layer=#3, to node=#4
    $\scriptscriptstyle w_{#4#2}^{(#3)}$
}
% Text on nodes
\newcommand{\nodetextclear}[2]{}
\newcommand{\nodetextxi}[2]{
    \ifnum0=#2\relax
        $b$
    \else
        $x_#2$
    \fi
}
\newcommand{\nodetexthi}[2]{
    \ifnum0=#2\relax
        $b$
    \else
        $a_#2^{(#1)}$
        %$h_#2$
    \fi
}
\newcommand{\nodetextyi}[2]{$y_#2$}
\newcommand{\nodetexts}[2]{$s$}
\newcommand{\nodetextsigma}[2]{$\Sigma$}
\newcommand{\nodetexty}[2]{$y$}
% Step function
\newcommand{\nodetextstep}[2]{
    \tikzstyle{input} = [coordinate]
    \begin{tikzpicture}[auto, >=latex']
        \draw[line width=0.05mm](0,0)  +(0,-6pt) -- +(0,6pt); % thin vert
        \draw[line width=0.25mm](0,0)  +(0pt,3pt) -- +(6pt,3pt); % wide top horiz
        \draw[line width=0.25mm](0,0)  +(0,-3pt) -- +(0,3pt); % wide vert
        \draw[line width=0.25mm](0,0)  +(-6pt,-3pt) -- +(0pt,-3pt); % wide top horiz
    \end{tikzpicture}
}
% Sigmoid function
\newcommand{\nodetextsigmoid}[2]{
    \begin{tikzpicture}[auto, >=latex']
        \begin{axis}[hide axis, scale only axis, height=2ex]
            \addplot[color=black]{1/(1+exp(-x))-2};
        \end{axis}
    \end{tikzpicture}
}
